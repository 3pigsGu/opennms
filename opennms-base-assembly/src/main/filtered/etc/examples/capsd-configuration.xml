<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- 24 hours --><capsd-configuration abort-protocol-scans-if-no-route="false" delete-propagation-enabled="true" initial-sleep-time="300000" management-policy="managed" max-rescan-thread-pool-size="3" max-suspect-thread-pool-size="6" rescan-frequency="86400000" xmlrpc="false">

    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.IcmpPlugin" protocol="ICMP" scan="on">
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.IcmpPlugin" protocol="StrafePing" scan="on">
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SnmpPlugin" protocol="SNMP" scan="on">
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HTTP" scan="on">
        <property key="port" value="80"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HTTP-8080" scan="on">
        <property key="port" value="8080"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HTTP-8000" scan="on">
        <property key="port" value="8000"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HTTP-HostExample" scan="on">
        <protocol-configuration scan="enable" user-defined="false">
            <specific>216.216.217.254</specific>
        </protocol-configuration>
        <property key="port" value="80"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpsPlugin" protocol="HTTPS" scan="on">
        <property key="port" value="443"/>
        <property key="timeout" value="5000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="HypericAgent" scan="on">
        <property key="port" value="2144"/>
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HypericHQ" scan="off">
        <property key="port" value="7080"/>
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.FtpPlugin" protocol="FTP" scan="on">
        <property key="port" value="21"/>
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Telnet" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="23"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DnsPlugin" protocol="DNS" scan="on">
        <property key="port" value="53"/>
        <property key="timeout" value="5000"/>
        <property key="retry" value="2"/>
        <property key="lookup" value="localhost"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.ImapPlugin" protocol="IMAP" scan="on">
        <property key="port" value="143"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.MSExchangePlugin" protocol="MSExchange" scan="on">
        <property key="pop3 port" value="110"/>
        <property key="imap port" value="143"/>
        <property key="mapi port" value="593"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SmtpPlugin" protocol="SMTP" scan="on">
        <property key="port" value="25"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Pop3Plugin" protocol="POP3" scan="on">
        <property key="port" value="110"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SshPlugin" protocol="SSH" scan="on">
        <property key="banner" value="SSH"/>
        <property key="port" value="22"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="MySQL" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="3306"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="SQLServer" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1433"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Oracle" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1521"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Postgres" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="5432"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SnmpPlugin" protocol="Router" scan="on">
        <property key="vbname" value=".1.3.6.1.2.1.4.1.0"/>
        <property key="vbvalue" value="1"/>
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="HP Insight Manager" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="2381"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Dell-OpenManage" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1311"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>    
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.NrpePlugin" protocol="NRPE" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="5666"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
        <property key="command" value="_NRPE_CHECK"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.NrpePlugin" protocol="NRPE-NoSSL" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="5666"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
        <property key="usessl" value="false"/>
        <property key="command" value="_NRPE_CHECK"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="Windows-Task-Scheduler" scan="on">
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
        <property key="service-name" value="Task Scheduler"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Jsr160Plugin" protocol="OpenNMS-JVM" scan="on" user-defined="false">
        <property key="port" value="18980"/>
        <property key="factory" value="PASSWORD-CLEAR"/>
        <property key="username" value="admin"/>
        <property key="password" value="admin"/>
        <property key="protocol" value="rmi"/>
        <property key="urlPath" value="/jmxrmi"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
        <property key="type" value="default"/>
    </protocol-plugin>

    <!--
        The following <protocol-plugin> tags contain examples of other types of 
        capsd plugins that can be added to the system 
    -->

    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Memcached" scan="on">
        <property key="port" value="11211"/>
        <property key="timeout" value="2000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.NtpPlugin" protocol="NTP" scan="on">
        <property key="port" value="123"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.NotesHttpPlugin" protocol="NotesHTTP" scan="on">
        <property key="port" value="80,8080"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DominoIIOPPlugin" protocol="DominoIIOP" scan="on">
        <property key="port" value="63148"/>
        <property key="ior-port" value="80"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.CitrixPlugin" protocol="Citrix" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.LdapPlugin" protocol="LDAP" scan="on">
        <property key="port" value="389"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SmbPlugin" protocol="SMB" scan="on"/>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.HttpPlugin" protocol="HTTP-MGMT" scan="on">
        <property key="port" value="280"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Informix" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1536"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="Sybase" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1498"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.JBossPlugin" protocol="JBoss4" scan="on">
         <property key="version" value="4"/>
         <property key="port" value="1099"/>
         <property key="retry" value="2"/>
         <property key="timeout" value="2000"/>
         <property key="factory" value="RMI"/>
         <!-- if you set the factory to HTTP (necessary when monitoring through a firewall) then you 
              need to ensure the port matches the port specified in the InvokerURLSuffix for the Naming Service entry in 
             <jboss-home>/server/default/deploy/http-invoker/META-INF/jboss-service.xml
              The default port is 8080
         -->
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.JBossPlugin" protocol="JBoss32" scan="on">
         <property key="version" value="32"/>
         <property key="port" value="1099"/>
         <property key="retry" value="2"/>
         <property key="timeout" value="2000"/>
         <property key="factory" value="RMI"/>
         <!-- if you set the factory to HTTP (necessary when monitoring through a firewall) then you 
              need to ensure the port matches the port specified in the InvokerURLSuffix for the Naming Service entry in 
              <jboss-home>/server/default/deploy/http-invoker/META-INF/jboss-service.xml
              The default port is 8080
          -->
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Jsr160Plugin" protocol="JVM" scan="on">
         <property key="port" value="9003"/>
         <property key="type" value="default"/>
         <property key="protocol" value="rmi"/>
         <property key="urlPath" value="/jmxrmi"/>
         <property key="retry" value="2"/>
         <property key="timeout" value="2000"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DiskUsagePlugin" protocol="DiskUsage-root" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="1"/>
        <property key="disk" value="/"/>
        <property key="match-type" value="exact"/><!-- This is the default if "match-type" is omitted -->
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DiskUsagePlugin" protocol="DiskUsage-home" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="1"/>
        <property key="disk" value="/home"/><!-- Would catch either "/home" or "/export/home" -->
        <property key="match-type" value="endsWith"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DiskUsagePlugin" protocol="DiskUsage-CDrive" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="1"/>
        <property key="disk" value="C:"/>
        <property key="match-type" value="startsWith"/><!-- Needed for Windows SNMP service, which appends label and serial number -->
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.DiskUsagePlugin" protocol="DiskUsage-BootDisk" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="1"/>
        <property key="disk" value="Label:Boot Disk"/><!-- For finding a Windows drive with a given label regardless of letter -->
        <property key="match-type" value="regex"/>
    </protocol-plugin>
    <!--
    Use the LoopPlugin to force a service for use with PassiveStatusMonitor or the LoopMonitor
    <protocol-plugin protocol="LOOP-BACK" class-name="org.opennms.netmgt.capsd.plugins.LoopPlugin" scan="on">
        <property key="ip-match" value="10.1.1.1-254" />
        <property key="is-supported" value="true" />
    </protocol-plugin>
    -->
    <!-- Using the LoopPlugin to simply establish a service monitored by the PassiveServiceMonitor a service  -->
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.LoopPlugin" protocol="NON-IP" scan="on">
        <property key="ip-match" value="169.254.*.*"/>
        <property key="is-supported" value="true"/>
    </protocol-plugin>
    <!--  Quick and dirty to set up the MAIL service on an interface -->
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.SmtpPlugin" protocol="MAIL" scan="on">
        <property key="port" value="25"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <!-- Detect the trivial UNIX time protocol on TCP port 37, monitor with TrivialTimeMonitor -->
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.TcpPlugin" protocol="UnixTime" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="37"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
<!--- Windows Exchange Service Monitors -->
<protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeSA" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeSA"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeADTopology" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeADTopology"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeAntispamUpdate" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeAntispamUpdate"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeEdgeSync" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeEdgeSync"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeFDS" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeFDS"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeServiceHost" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeServiceHost"/>
    </protocol-plugin>
<protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeTransport" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeTransport"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeMailSubmission" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeMailSubmission"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeMailboxAssistants" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeMailboxAssistants"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.Win32ServicePlugin" protocol="MSExchangeSA" scan="on">
        <property key="timeout" value="3000000"/>
        <property key="retry" value="1"/>
        <property key="service-name" value="MSExchangeSA"/>
    </protocol-plugin>
<!-- WMI Monitoring -->
    <protocol-plugin class-name="org.opennms.netmgt.capsd.plugins.WmiPlugin" protocol="WMI" scan="on" user-defined="false">
        <property key="timeout" value="2000"/>
        <property key="retry" value="1"/>
        <property key="matchType" value="all"/>
        <property key="wmiClass" value="Win32_ComputerSystem"/>
        <property key="wmiObject" value="Status"/>
        <property key="compareOp" value="EQ"/>
        <property key="compareValue" value="OK"/>
        <property key="service-name" value="WMI"/>
    </protocol-plugin>

    <!--  The DHCP plugin is now distributed separately and must be installed before enabling this -->
    <protocol-plugin class-name="org.opennms.protocols.dhcp.capsd.DhcpPlugin" protocol="DHCP" scan="on">
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>

    <!--  The NSClient plugin is now distributed separately and must be installed before enabling this -->
    <protocol-plugin class-name="org.opennms.protocols.nsclient.capsd.NsclientPlugin" protocol="NSClient" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="1248"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    <protocol-plugin class-name="org.opennms.protocols.nsclient.capsd.NsclientPlugin" protocol="NSClientpp" scan="on">
        <property key="banner" value="*"/>
        <property key="port" value="12489"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="2"/>
    </protocol-plugin>
    
    <!--  The RADIUS plugin is now distributed separately and must be installed before enabling this -->
    <protocol-plugin class-name="org.opennms.protocols.radius.capsd.RadiusAuthPlugin" protocol="RadiusAuth" scan="on">
        <property key="timeout" value="3000"/>
        <property key="user" value="TEST"/>
        <property key="password" value="test"/>
        <property key="secret" value="opennms"/>
        <property key="retry" value="2"/>
    </protocol-plugin>

    <!--  XMP/Cartographer plugin: see http://www.krupczak.org/index.php/Cartographer for more information -->
    <!--  The XMP plugin is now distributed separately and must be installed before enabling this -->
    <protocol-plugin class-name="org.opennms.protocols.xmp.capsd.XmpPlugin" protocol="XMP" scan="on" user-defined="false">
        <property key="port" value="5270"/>
        <property key="timeout" value="3000"/>
        <property key="retry" value="1"/>
    </protocol-plugin>
    
    
    <smb-config>
        <smb-auth password="guest" type="domain" user="guest">WORKGROUP</smb-auth>
    </smb-config>
    <ip-management policy="managed">
        <range begin="192.168.0.0" end="192.168.0.255"/>
        <include-url>file:${install.etc.dir}/include</include-url>
    </ip-management>
    <ip-management policy="unmanaged">
        <specific>0.0.0.0</specific>
        <range begin="127.0.0.0" end="127.255.255.255"/>
    </ip-management>
</capsd-configuration>