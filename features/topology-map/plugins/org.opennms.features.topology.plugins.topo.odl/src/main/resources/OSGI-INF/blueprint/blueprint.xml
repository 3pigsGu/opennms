<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <reference id="nodeDao" interface="org.opennms.netmgt.dao.api.NodeDao" availability="mandatory"/>
    <reference id="alarmDao" interface="org.opennms.netmgt.dao.api.AlarmDao" availability="mandatory" />

    <!-- Topology Provider -->
    <bean id="odlTopologyProvider" scope="prototype"
        class="org.opennms.features.topology.plugins.topo.odl.OpendaylightTopologyProvider">
        <property name="nodeDao" ref="nodeDao"/>
    </bean>
    <bean id="odlTopologyHopProvider"
        class="org.opennms.features.topology.api.support.VertexHopGraphProvider">
        <argument ref="odlTopologyProvider" />
    </bean>
    <service interface="org.opennms.features.topology.api.topo.VertexProvider"
        ref="odlTopologyHopProvider">
        <service-properties>
            <entry key="label" value="Opendaylight" />
        </service-properties>
    </service>
    <service interface="org.opennms.features.topology.api.topo.EdgeProvider" ref="odlTopologyHopProvider">
        <service-properties>
            <entry key="label" value="Opendaylight" />
        </service-properties>
    </service>
    <service interface="org.opennms.features.topology.api.topo.GraphProvider" ref="odlTopologyHopProvider">
        <service-properties>
            <entry key="label" value="Opendaylight" />
        </service-properties>
    </service>

    <!-- Meta topology provider -->
    <bean id="odlMetaTopologyProvider" class="org.opennms.features.topology.api.topo.SimpleMetaTopologyProvider">
        <argument ref="odlTopologyHopProvider" />
    </bean>

    <service interface="org.opennms.features.topology.api.topo.MetaTopologyProvider" ref="odlMetaTopologyProvider">
        <service-properties>
            <entry key="label" value="OpenDaylight" />
        </service-properties>
    </service>

    <!-- Search Provider -->
    <bean id="odlSearchProvider" class="org.opennms.features.topology.plugins.topo.odl.OpendaylightSearchProvider">
        <property name="nodeDao" ref="nodeDao"/>
    </bean>
    <service interface="org.opennms.features.topology.api.topo.SearchProvider" ref="odlSearchProvider" />

    <!-- Status provider -->
    <bean id="statusProvider" class="org.opennms.features.topology.plugins.topo.odl.AlarmStatusProvider">
        <argument ref="alarmDao"/>
    </bean>
    <service interface="org.opennms.features.topology.api.topo.StatusProvider" ref="statusProvider" />

  <!-- Icon definition -->
  <service>
    <interfaces>
      <value>org.opennms.features.topology.api.ConfigurableIconRepository</value>
      <value>org.osgi.service.cm.ManagedService</value>
    </interfaces>
    <service-properties>
      <entry key="service.pid" value="org.opennms.features.topology.app.icons.odl"/>
    </service-properties>
    <bean class="org.opennms.features.topology.api.support.DefaultIconRepository" />
  </service>
</blueprint>
