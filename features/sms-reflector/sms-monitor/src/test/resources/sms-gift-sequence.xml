<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<mobile-sequence xmlns="http://xmlns.opennms.org/xsd/config/mobile-sequence">
  <transaction label="SMS gift">
    <operation type="send-sms" label="sending ping">
      <value>'tis better to give...</value>
      <parameters>
        <parameter key="destination" value="*327${recipient}" />
      </parameters>
    </operation>
    <transaction type="asynchronous">
      <transaction>
        <operation type="receive-sms" label="receive ping">
          <match type="success">'tis better to give... [Responda gratis]</match>
          <!-- store the source phone number to the session variable "source" -->
          <parameter key="store-source" value="source" />
        </operation>
        <operation type="send-sms" label="send pong">
          <value>...than to receive.</value>
          <parameters>
            <parameter key="destination" value="${session.source}" />
          </parameters>
        </operation>
      </transaction>
      <operation> type="receive-sms" label="receive pong">
        <match type="success">~than to receive</match>
        <parameters>
          <parameter key="validate-source" value="+327${recipient}" />
        </parameters>
      </operation>
    </transaction>
  </transaction>
</mobile-sequence>
