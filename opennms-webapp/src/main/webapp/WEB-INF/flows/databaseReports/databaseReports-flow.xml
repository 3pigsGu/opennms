<?xml version="1.0" encoding="UTF-8"?>
<flow xmlns="http://www.springframework.org/schema/webflow"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow
                          http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd">

	<on-start>
		<evaluate expression="databaseReportBuilderService.newCriteria()" result="flowScope.criteria" />
	</on-start>

    <view-state id="reportSelector" model="criteria">
    	<binder>
        	<binding property="reportId" />
    	</binder>
    	<on-render>
   			<evaluate expression="databaseReportBuilderService.getReports()" result="viewScope.reports" />
</on-render>
        <transition on="proceed" to="enterReportParameters" />
    </view-state>
	
    <view-state id="reportParameters" model="criteria">
        <transition on="proceed" to="selectReportDelivery" />
        <transition on="revise" to="selectReport" />
        <transition on="cancel" to="reportCancelled" />
    </view-state>
    
    <view-state id="reportDelivery">
        <transition on="proceed" to="submitReport" />
        <transition on="revise" to="selectReport" />
        <transition on="cancel" to="reportCancelled" />
    </view-state>
	
    <end-state id="submitReport"/>

    <end-state id="reportCancelled" />
		
</flow>
